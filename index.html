export default {
  async fetch() {
    // GitHubのraw JSONを毎回取得（no-storeで確実に最新）
    const res = await fetch("https://raw.githubusercontent.com/<username>/<repo>/main/config.json", {
      cache: "no-store"
    });
    let target = "https://example.com";
    try {
      const { target: t } = await res.json();
      if (typeof t === "string" && t) target = t;
    } catch (_) {}

    return new Response(null, {
      status: 302,
      headers: {
        "Location": target,
        "Cache-Control": "no-store, no-cache, must-revalidate, max-age=0",
        "Pragma": "no-cache",
        "Expires": "0",
      },
    });
  }
}
